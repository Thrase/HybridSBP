#{{{
const BAE_t = 2.3099913397992207e+10
const BAE_z       = [0.0000000000000000e+00, +8.9999999999999997e-02, +1.7999999999999999e-01, +2.7000000000000002e-01, +3.5999999999999999e-01, +4.4999999999999996e-01, +5.4000000000000004e-01, +6.3000000000000000e-01, +7.1999999999999997e-01, +8.0999999999999994e-01, +8.9999999999999991e-01, +9.8999999999999999e-01, +1.0800000000000001e+00, +1.1699999999999999e+00, +1.2600000000000000e+00, +1.3499999999999999e+00, +1.4399999999999999e+00, +1.5300000000000000e+00, +1.6199999999999999e+00, +1.7100000000000000e+00, +1.7999999999999998e+00, +1.8899999999999999e+00, +1.9800000000000000e+00, +2.0699999999999998e+00, +2.1600000000000001e+00, +2.2500000000000000e+00, +2.3399999999999999e+00, +2.4299999999999997e+00, +2.5200000000000000e+00, +2.6099999999999999e+00, +2.6999999999999997e+00, +2.7900000000000000e+00, +2.8799999999999999e+00, +2.9699999999999998e+00, +3.0600000000000001e+00, +3.1499999999999999e+00, +3.2399999999999998e+00, +3.3300000000000001e+00, +3.4199999999999999e+00, +3.5099999999999998e+00, +3.5999999999999996e+00, +3.6899999999999999e+00, +3.7799999999999998e+00, +3.8699999999999997e+00, +3.9600000000000000e+00, +4.0499999999999998e+00, +4.1399999999999997e+00, +4.2299999999999995e+00, +4.3200000000000003e+00, +4.4100000000000001e+00, +4.5000000000000000e+00, +4.5899999999999999e+00, +4.6799999999999997e+00, +4.7699999999999996e+00, +4.8599999999999994e+00, +4.9500000000000002e+00, +5.0400000000000000e+00, +5.1299999999999999e+00, +5.2199999999999998e+00, +5.3099999999999996e+00, +5.3999999999999995e+00, +5.4900000000000002e+00, +5.5800000000000001e+00, +5.6699999999999999e+00, +5.7599999999999998e+00, +5.8499999999999996e+00, +5.9399999999999995e+00, +6.0299999999999994e+00, +6.1200000000000001e+00, +6.2100000000000000e+00, +6.2999999999999998e+00, +6.3899999999999997e+00, +6.4799999999999995e+00, +6.5699999999999994e+00, +6.6600000000000001e+00, +6.7500000000000000e+00, +6.8399999999999999e+00, +6.9299999999999997e+00, +7.0199999999999996e+00, +7.1099999999999994e+00, +7.1999999999999993e+00, +7.2900000000000000e+00, +7.3799999999999999e+00, +7.4699999999999998e+00, +7.5599999999999996e+00, +7.6499999999999995e+00, +7.7399999999999993e+00, +7.8300000000000001e+00, +7.9199999999999999e+00, +8.0099999999999998e+00, +8.0999999999999996e+00, +8.1899999999999995e+00, +8.2799999999999994e+00, +8.3699999999999992e+00, +8.4599999999999991e+00, +8.5499999999999989e+00, +8.6400000000000006e+00, +8.7300000000000004e+00, +8.8200000000000003e+00, +8.9100000000000001e+00, +9.0000000000000000e+00, +9.0899999999999999e+00, +9.1799999999999997e+00, +9.2699999999999996e+00, +9.3599999999999994e+00, +9.4499999999999993e+00, +9.5399999999999991e+00, +9.6299999999999990e+00, +9.7199999999999989e+00, +9.8100000000000005e+00, +9.9000000000000004e+00, +9.9900000000000002e+00, +1.0080000000000000e+01, +1.0170000000000000e+01, +1.0260000000000000e+01, +1.0350000000000000e+01, +1.0440000000000000e+01, +1.0529999999999999e+01, +1.0619999999999999e+01, +1.0709999999999999e+01, +1.0799999999999999e+01, +1.0889999999999999e+01, +1.0980000000000000e+01, +1.1070000000000000e+01, +1.1160000000000000e+01, +1.1250000000000000e+01, +1.1340000000000000e+01, +1.1430000000000000e+01, +1.1520000000000000e+01, +1.1609999999999999e+01, +1.1699999999999999e+01, +1.1789999999999999e+01, +1.1879999999999999e+01, +1.1969999999999999e+01, +1.2059999999999999e+01, +1.2150000000000000e+01, +1.2240000000000000e+01, +1.2330000000000000e+01, +1.2420000000000000e+01, +1.2510000000000000e+01, +1.2600000000000000e+01, +1.2690000000000000e+01, +1.2779999999999999e+01, +1.2869999999999999e+01, +1.2959999999999999e+01, +1.3049999999999999e+01, +1.3139999999999999e+01, +1.3229999999999999e+01, +1.3320000000000000e+01, +1.3410000000000000e+01, +1.3500000000000000e+01, +1.3590000000000000e+01, +1.3680000000000000e+01, +1.3770000000000000e+01, +1.3859999999999999e+01, +1.3949999999999999e+01, +1.4039999999999999e+01, +1.4129999999999999e+01, +1.4219999999999999e+01, +1.4309999999999999e+01, +1.4399999999999999e+01, +1.4490000000000000e+01, +1.4580000000000000e+01, +1.4670000000000000e+01, +1.4760000000000000e+01, +1.4850000000000000e+01, +1.4940000000000000e+01, +1.5029999999999999e+01, +1.5119999999999999e+01, +1.5209999999999999e+01, +1.5299999999999999e+01, +1.5389999999999999e+01, +1.5479999999999999e+01, +1.5570000000000000e+01, +1.5660000000000000e+01, +1.5750000000000000e+01, +1.5840000000000000e+01, +1.5930000000000000e+01, +1.6020000000000000e+01, +1.6109999999999999e+01, +1.6199999999999999e+01, +1.6289999999999999e+01, +1.6379999999999999e+01, +1.6469999999999999e+01, +1.6559999999999999e+01, +1.6649999999999999e+01, +1.6739999999999998e+01, +1.6829999999999998e+01, +1.6919999999999998e+01, +1.7009999999999998e+01, +1.7099999999999998e+01, +1.7189999999999998e+01, +1.7280000000000001e+01, +1.7370000000000001e+01, +1.7460000000000001e+01, +1.7550000000000001e+01, +1.7640000000000001e+01, +1.7730000000000000e+01, +1.7820000000000000e+01, +1.7910000000000000e+01, +1.8000000000000000e+01, +1.8090000000000000e+01, +1.8180000000000000e+01, +1.8270000000000000e+01, +1.8359999999999999e+01, +1.8449999999999999e+01, +1.8539999999999999e+01, +1.8629999999999999e+01, +1.8719999999999999e+01, +1.8810000000000002e+01, +1.8900000000000002e+01, +1.8990000000000002e+01, +1.9080000000000002e+01, +1.9170000000000002e+01, +1.9260000000000002e+01, +1.9350000000000001e+01, +1.9440000000000001e+01, +1.9530000000000001e+01, +1.9620000000000001e+01, +1.9710000000000001e+01, +1.9800000000000001e+01, +1.9890000000000001e+01, +1.9980000000000000e+01, +2.0070000000000000e+01, +2.0160000000000000e+01, +2.0250000000000000e+01, +2.0340000000000000e+01, +2.0430000000000000e+01, +2.0520000000000003e+01, +2.0609999999999999e+01, +2.0700000000000003e+01, +2.0789999999999999e+01, +2.0880000000000003e+01, +2.0969999999999999e+01, +2.1060000000000002e+01, +2.1149999999999999e+01, +2.1240000000000002e+01, +2.1329999999999998e+01, +2.1420000000000002e+01, +2.1509999999999998e+01, +2.1600000000000001e+01, +2.1690000000000001e+01, +2.1780000000000001e+01, +2.1870000000000001e+01, +2.1960000000000001e+01, +2.2050000000000001e+01, +2.2140000000000001e+01, +2.2230000000000000e+01, +2.2320000000000000e+01, +2.2410000000000000e+01, +2.2500000000000000e+01, +2.2590000000000000e+01, +2.2680000000000000e+01, +2.2770000000000003e+01, +2.2859999999999999e+01, +2.2950000000000003e+01, +2.3039999999999999e+01, +2.3130000000000003e+01, +2.3219999999999999e+01, +2.3310000000000002e+01, +2.3399999999999999e+01, +2.3490000000000002e+01, +2.3579999999999998e+01, +2.3670000000000002e+01, +2.3759999999999998e+01, +2.3850000000000001e+01, +2.3940000000000001e+01, +2.4030000000000001e+01, +2.4120000000000001e+01, +2.4210000000000001e+01, +2.4300000000000001e+01, +2.4390000000000001e+01, +2.4480000000000000e+01, +2.4570000000000000e+01, +2.4660000000000000e+01, +2.4750000000000000e+01, +2.4840000000000000e+01, +2.4930000000000000e+01, +2.5020000000000000e+01, +2.5109999999999999e+01, +2.5200000000000003e+01, +2.5289999999999999e+01, +2.5380000000000003e+01, +2.5469999999999999e+01, +2.5560000000000002e+01, +2.5649999999999999e+01, +2.5740000000000002e+01, +2.5829999999999998e+01, +2.5920000000000002e+01, +2.6009999999999998e+01, +2.6100000000000001e+01, +2.6189999999999998e+01, +2.6280000000000001e+01, +2.6370000000000001e+01, +2.6460000000000001e+01, +2.6550000000000001e+01, +2.6640000000000001e+01, +2.6730000000000000e+01, +2.6820000000000000e+01, +2.6910000000000000e+01, +2.7000000000000000e+01, +2.7090000000000000e+01, +2.7180000000000000e+01, +2.7270000000000000e+01, +2.7359999999999999e+01, +2.7450000000000003e+01, +2.7539999999999999e+01, +2.7630000000000003e+01, +2.7719999999999999e+01, +2.7810000000000002e+01, +2.7899999999999999e+01, +2.7990000000000002e+01, +2.8079999999999998e+01, +2.8170000000000002e+01, +2.8260000000000002e+01, +2.8350000000000001e+01, +2.8440000000000001e+01, +2.8530000000000001e+01, +2.8620000000000001e+01, +2.8710000000000001e+01, +2.8800000000000001e+01, +2.8890000000000001e+01, +2.8980000000000000e+01, +2.9070000000000000e+01, +2.9160000000000000e+01, +2.9250000000000000e+01, +2.9340000000000000e+01, +2.9430000000000000e+01, +2.9520000000000000e+01, +2.9609999999999999e+01, +2.9699999999999999e+01, +2.9789999999999999e+01, +2.9879999999999999e+01, +2.9969999999999999e+01, +3.0060000000000002e+01, +3.0149999999999999e+01, +3.0240000000000002e+01, +3.0329999999999998e+01, +3.0420000000000002e+01, +3.0509999999999998e+01, +3.0600000000000001e+01, +3.0690000000000001e+01, +3.0780000000000001e+01, +3.0870000000000001e+01, +3.0960000000000001e+01, +3.1050000000000001e+01, +3.1140000000000001e+01, +3.1230000000000000e+01, +3.1320000000000000e+01, +3.1410000000000000e+01, +3.1500000000000000e+01, +3.1590000000000000e+01, +3.1680000000000000e+01, +3.1770000000000000e+01, +3.1859999999999999e+01, +3.1949999999999999e+01, +3.2039999999999999e+01, +3.2130000000000003e+01, +3.2219999999999999e+01, +3.2310000000000002e+01, +3.2399999999999999e+01, +3.2490000000000002e+01, +3.2579999999999998e+01, +3.2670000000000002e+01, +3.2759999999999998e+01, +3.2850000000000001e+01, +3.2939999999999998e+01, +3.3030000000000001e+01, +3.3119999999999997e+01, +3.3210000000000001e+01, +3.3299999999999997e+01, +3.3390000000000001e+01, +3.3479999999999997e+01, +3.3570000000000000e+01, +3.3659999999999997e+01, +3.3750000000000000e+01, +3.3840000000000003e+01, +3.3930000000000000e+01, +3.4020000000000003e+01, +3.4109999999999999e+01, +3.4200000000000003e+01, +3.4289999999999999e+01, +3.4380000000000003e+01, +3.4469999999999999e+01, +3.4560000000000002e+01, +3.4649999999999999e+01, +3.4740000000000002e+01, +3.4829999999999998e+01, +3.4920000000000002e+01, +3.5009999999999998e+01, +3.5100000000000001e+01, +3.5189999999999998e+01, +3.5280000000000001e+01, +3.5369999999999997e+01, +3.5460000000000001e+01, +3.5549999999999997e+01, +3.5640000000000001e+01, +3.5729999999999997e+01, +3.5820000000000000e+01, +3.5909999999999997e+01, +3.6000000000000000e+01]
const BAE_δ       = [1.6327995435745422e+01, +1.6336511734544320e+01, +1.6361943808991022e+01, +1.6403828318520944e+01, +1.6460838274520597e+01, +1.6529665564433927e+01, +1.6599039522059194e+01, +1.6661430478266784e+01, +1.6718634429199572e+01, +1.6772086201424923e+01, +1.6822469575303987e+01, +1.6870193667100899e+01, +1.6915569215344966e+01, +1.6958849226175296e+01, +1.7000243724962985e+01, +1.7039929741499378e+01, +1.7078058414880257e+01, +1.7114760107964504e+01, +1.7150148222378469e+01, +1.7184322127119831e+01, +1.7217369453673651e+01, +1.7249367923946515e+01, +1.7280386825490524e+01, +1.7310488215397882e+01, +1.7339727912241333e+01, +1.7368156320298322e+01, +1.7395819119590971e+01, +1.7422757847528707e+01, +1.7449010392230910e+01, +1.7474611413330383e+01, +1.7499592702812865e+01, +1.7523983495953928e+01, +1.7547810740478411e+01, +1.7571099330551483e+01, +1.7593872311011616e+01, +1.7616151056301611e+01, +1.7637955427788544e+01, +1.7659303912545614e+01, +1.7680213746167624e+01, +1.7700701021781715e+01, +1.7720780787078734e+01, +1.7740467130912730e+01, +1.7759773260786343e+01, +1.7778711572347156e+01, +1.7797293711860892e+01, +1.7815530632490855e+01, +1.7833432645101428e+01, +1.7851009464205148e+01, +1.7868270249592843e+01, +1.7885223644115495e+01, +1.7901877808027518e+01, +1.7918240450250021e+01, +1.7934318856868092e+01, +1.7950119917138700e+01, +1.7965650147252909e+01, +1.7980915712067087e+01, +1.7995922444993379e+01, +1.8010675866217653e+01, +1.8025181199394734e+01, +1.8039443386952755e+01, +1.8053467104125716e+01, +1.8067256771818094e+01, +1.8080816568395790e+01, +1.8094150440486231e+01, +1.8107262112861992e+01, +1.8120155097473539e+01, +1.8132832701690301e+01, +1.8145298035801549e+01, +1.8157554019823490e+01, +1.8169603389652892e+01, +1.8181448702603188e+01, +1.8193092342353708e+01, +1.8204536523339048e+01, +1.8215783294600897e+01, +1.8226834543121999e+01, +1.8237691996656917e+01, +1.8248357226071949e+01, +1.8258831647202548e+01, +1.8269116522233876e+01, +1.8279212960605975e+01, +1.8289121919442881e+01, +1.8298844203500291e+01, +1.8308380464624058e+01, +1.8317731200707865e+01, +1.8326896754133891e+01, +1.8335877309676707e+01, +1.8344672891846916e+01, +1.8353283361644490e+01, +1.8361708412688106e+01, +1.8369947566679738e+01, +1.8378000168158298e+01, +1.8385865378487477e+01, +1.8393542169016047e+01, +1.8401029313338093e+01, +1.8408325378571501e+01, +1.8415428715559067e+01, +1.8422337447883976e+01, +1.8429049459574035e+01, +1.8435562381350834e+01, +1.8441873575257482e+01, +1.8447980117472760e+01, +1.8453878779089507e+01, +1.8459566004598599e+01, +1.8465037887777871e+01, +1.8470290144633715e+01, +1.8475318082982810e+01, +1.8480116568187889e+01, +1.8484679984471864e+01, +1.8489002191127067e+01, +1.8493076472802226e+01, +1.8496895482886345e+01, +1.8500451178803115e+01, +1.8503734747774178e+01, +1.8506736521283674e+01, +1.8509445876063829e+01, +1.8511851118886749e+01, +1.8513939351751365e+01, +1.8515696313136587e+01, +1.8517106189762142e+01, +1.8518151391630031e+01, +1.8518812280814448e+01, +1.8519066841222642e+01, +1.8518890271882178e+01, +1.8518254479427203e+01, +1.8517127435021738e+01, +1.8515472344600997e+01, +1.8513246554688266e+01, +1.8510400070708616e+01, +1.8506873483344545e+01, +1.8502594942981130e+01, +1.8497475502539988e+01, +1.8491401433262375e+01, +1.8484220356925753e+01, +1.8475749398967587e+01, +1.8464778932394605e+01, +1.8451868031988177e+01, +1.8437689190134257e+01, +1.8422381435520933e+01, +1.8406033786047917e+01, +1.8388682748256318e+01, +1.8370314148417012e+01, +1.8350854978574116e+01, +1.8330153591574206e+01, +1.8307941012897885e+01, +1.8283755384676581e+01, +1.8256788915258010e+01, +1.8225858466633799e+01, +1.8174595579548591e+01, +1.8115449908965850e+01, +1.8068606377835973e+01, +1.8045384071642761e+01, +1.8069906916660894e+01, +1.8106933751326558e+01, +1.8144122994171251e+01, +1.8181267011907181e+01, +1.8218314844006766e+01, +1.8255220070359258e+01, +1.8291935799306003e+01, +1.8328413762685805e+01, +1.8364603639797906e+01, +1.8400452251045525e+01, +1.8435902485368722e+01, +1.8470891787130817e+01, +1.8505349902930455e+01, +1.8539195300859006e+01, +1.8572329014420163e+01, +1.8604622976516996e+01, +1.8635941584478459e+01, +1.8664856491510520e+01, +1.8693179081418705e+01, +1.8720695986449773e+01, +1.8747501600503586e+01, +1.8773659717256827e+01, +1.8799221443796970e+01, +1.8824228963220282e+01, +1.8848717904796104e+01, +1.8872718911770942e+01, +1.8896258724176281e+01, +1.8919360953367232e+01, +1.8942046653391472e+01, +1.8964334753566298e+01, +1.8986242393584011e+01, +1.9007785186327062e+01, +1.9028977430202605e+01, +1.9049832281237578e+01, +1.9070361892697257e+01, +1.9090577534374841e+01, +1.9110489691200986e+01, +1.9130108147209846e+01, +1.9149442057279913e+01, +1.9168500008910083e+01, +1.9187290075765262e+01, +1.9205819864368564e+01, +1.9224096555039651e+01, +1.9242126937971673e+01, +1.9259917445172146e+01, +1.9277474178863564e+01, +1.9294802936837861e+01, +1.9311909235176515e+01, +1.9328798328678712e+01, +1.9345475229291964e+01, +1.9361944722786866e+01, +1.9378211383890331e+01, +1.9394279590053991e+01, +1.9410153534014249e+01, +1.9425837235276326e+01, +1.9441334550638938e+01, +1.9456649183860609e+01, +1.9471784694553573e+01, +1.9486744506386568e+01, +1.9501531914660532e+01, +1.9516150093318590e+01, +1.9530602101444533e+01, +1.9544890889294777e+01, +1.9559019303906997e+01, +1.9572990094322261e+01, +1.9586805916454608e+01, +1.9600469337636923e+01, +1.9613982840870833e+01, +1.9627348828804482e+01, +1.9640569627461101e+01, +1.9653647489734510e+01, +1.9666584598675296e+01, +1.9679383070577682e+01, +1.9692044957885589e+01, +1.9704572251930912e+01, +1.9716966885514029e+01, +1.9729230735341655e+01, +1.9741365624326825e+01, +1.9753373323764944e+01, +1.9765255555393200e+01, +1.9777013993339555e+01, +1.9788650265970585e+01, +1.9800165957643824e+01, +1.9811562610370743e+01, +1.9822841725395779e+01, +1.9834004764698420e+01, +1.9845053152420249e+01, +1.9855988276223865e+01, +1.9866811488586329e+01, +1.9877524108033072e+01, +1.9888127420311076e+01, +1.9898622679512407e+01, +1.9909011109142750e+01, +1.9919293903144002e+01, +1.9929472226870722e+01, +1.9939547218023712e+01, +1.9949519987542743e+01, +1.9959391620461627e+01, +1.9969163176725417e+01, +1.9978835691975153e+01, +1.9988410178297524e+01, +1.9997887624945825e+01, +2.0007268999030021e+01, +2.0016555246179998e+01, +2.0025747291180487e+01, +2.0034846038583158e+01, +2.0043852373292328e+01, +2.0052767161129950e+01, +2.0061591249377184e+01, +2.0070325467296438e+01, +2.0078970626632604e+01, +2.0087527522096508e+01, +2.0095996931829944e+01, +2.0104379617853287e+01, +2.0112676326497070e+01, +2.0120887788818141e+01, +2.0129014721000392e+01, +2.0137057824741337e+01, +2.0145017787625420e+01, +2.0152895283483531e+01, +2.0160690972741065e+01, +2.0168405502752559e+01, +2.0176039508126408e+01, +2.0183593611037129e+01, +2.0191068421528463e+01, +2.0198464537805105e+01, +2.0205782546515657e+01, +2.0213023023025499e+01, +2.0220186531681605e+01, +2.0227273626068254e+01, +2.0234284849253914e+01, +2.0241220734031028e+01, +2.0248081803148761e+01, +2.0254868569536661e+01, +2.0261581536522371e+01, +2.0268221198042653e+01, +2.0274788038847507e+01, +2.0281282534698121e+01, +2.0287705152558477e+01, +2.0294056350781805e+01, +2.0300336579291056e+01, +2.0306546279753064e+01, +2.0312685885749314e+01, +2.0318755822940350e+01, +2.0324756509224787e+01, +2.0330688354896097e+01, +2.0336551762791508e+01, +2.0342347128439421e+01, +2.0348074840200958e+01, +2.0353735279408017e+01, +2.0359328820496611e+01, +2.0364855831138147e+01, +2.0370316672365359e+01, +2.0375711698694303e+01, +2.0381041258245840e+01, +2.0386305692859445e+01, +2.0391505338207505e+01, +2.0396640523904910e+01, +2.0401711573615163e+01, +2.0406718805154657e+01, +2.0411662530593379e+01, +2.0416543056353063e+01, +2.0421360683303138e+01, +2.0426115706852265e+01, +2.0430808417040769e+01, +2.0435439098626674e+01, +2.0440008031172560e+01, +2.0444515489128243e+01, +2.0448961741911614e+01, +2.0453347053988448e+01, +2.0457671684948298e+01, +2.0461935889579749e+01, +2.0466139917943124e+01, +2.0470284015440928e+01, +2.0474368422887370e+01, +2.0478393376575344e+01, +2.0482359108341715e+01, +2.0486265845631095e+01, +2.0490113811557510e+01, +2.0493903224965177e+01, +2.0497634300487409e+01, +2.0501307248603062e+01, +2.0504922275693168e+01, +2.0508479584094488e+01, +2.0511979372152492e+01, +2.0515421834273575e+01, +2.0518807160973594e+01, +2.0522135538928278e+01, +2.0525407151019515e+01, +2.0528622176381774e+01, +2.0531780790447772e+01, +2.0534883164990983e+01, +2.0537929468169843e+01, +2.0540919864567755e+01, +2.0543854515234262e+01, +2.0546733577724034e+01, +2.0549557206134878e+01, +2.0552325551145170e+01, +2.0555038760050067e+01, +2.0557696976796070e+01, +2.0560300342015609e+01, +2.0562848993060349e+01, +2.0565343064032891e+01, +2.0567782685818631e+01, +2.0570167986115941e+01, +2.0572499089465811e+01, +2.0574776117280461e+01, +2.0576999187871021e+01, +2.0579168416474872e+01, +2.0581283915281880e+01, +2.0583345793459305e+01, +2.0585354157176816e+01, +2.0587309109630400e+01, +2.0589210751065043e+01, +2.0591059178797423e+01, +2.0592854487237297e+01, +2.0594596767908559e+01, +2.0596286109469361e+01, +2.0597922597731493e+01, +2.0599506315679278e+01, +2.0601037343487523e+01, +2.0602515758539244e+01, +2.0603941635442315e+01, +2.0605315046045391e+01, +2.0606636059453791e+01, +2.0607904742044031e+01, +2.0609121157478388e+01, +2.0610285366718195e+01, +2.0611397428037002e+01, +2.0612457397033062e+01, +2.0613465326641048e+01, +2.0614421267143587e+01, +2.0615325266181184e+01, +2.0616177368763065e+01, +2.0616977617276202e+01, +2.0617726051494476e+01, +2.0618422708586937e+01, +2.0619067623125495e+01, +2.0619660827092446e+01, +2.0620202349886920e+01, +2.0620692218331257e+01, +2.0621130456676351e+01, +2.0621517086606719e+01, +2.0621852127245297e+01, +2.0622135595157317e+01, +2.0622367504353704e+01, +2.0622547866293736e+01, +2.0622676689887840e+01, +2.0622753981532881e+01, +2.0622779744878834e+01]
const BAE_V_log10 = [4.7257246710829853e-01, +4.7570019280836595e-01, +4.8359165081558630e-01, +4.9303857976126986e-01, +4.9886924254099668e-01, +4.8194989565327417e-01, +4.0092772645276920e-01, +3.3144137384766265e-01, +2.7896958734812410e-01, +2.3489029364007510e-01, +1.9584529348499205e-01, +1.6061730270739133e-01, +1.2850383996617418e-01, +9.8983663653533199e-02, +7.1657469138846089e-02, +4.6213617157679021e-02, +2.2403352435229170e-02, +2.4383305812895305e-05, -2.1090264295157524e-02, -4.1080136914051685e-02, -6.0063108575314834e-02, -7.8139676094272442e-02, -9.5396227166628794e-02, -1.1190756783867593e-01, -1.2773890491571946e-01, -1.4294742007735362e-01, -1.5758353348247453e-01, -1.7169192804803682e-01, -1.8531238705972713e-01, -1.9848048462966056e-01, -2.1122815903000100e-01, -2.2358419199657134e-01, -2.3557461191145102e-01, -2.4722303492701339e-01, -2.5855095514133913e-01, -2.6957799266919413e-01, -2.8032210673833374e-01, -2.9079977953867420e-01, -3.0102617550810112e-01, -3.1101527988910238e-01, -3.2078001969466641e-01, -3.3033236969013924e-01, -3.3968344556984131e-01, -3.4884358613830641e-01, -3.5782242599359082e-01, -3.6662896001878420e-01, -3.7527160076749383e-01, -3.8375822963738826e-01, -3.9209624264130793e-01, -4.0029259144999851e-01, -4.0835382024802780e-01, -4.1628609896057583e-01, -4.2409525321155883e-01, -4.3178679144379095e-01, -4.3936592948218289e-01, -4.4683761285277035e-01, -4.5420653707754666e-01, -4.6147716617454726e-01, -4.6865374955603101e-01, -4.7574033749259970e-01, -4.8274079525306451e-01, -4.8965881611146822e-01, -4.9649793328649006e-01, -5.0326153094014880e-01, -5.0995285432279802e-01, -5.1657501911640802e-01, -5.2313102011914625e-01, -5.2962373924303474e-01, -5.3605595295728969e-01, -5.4243033918668671e-01, -5.4874948374184895e-01, -5.5501588628156373e-01, -5.6123196589562707e-01, -5.6740006629018391e-01, -5.7352246065324064e-01, -5.7960135619217090e-01, -5.8563889838078032e-01, -5.9163717494417334e-01, -5.9759821958819570e-01, -6.0352401549890600e-01, -6.0941649862811298e-01, -6.1527756076731610e-01, -6.2110905244314585e-01, -6.2691278561942221e-01, -6.3269053623138249e-01, -6.3844404655695619e-01, -6.4417502741909605e-01, -6.4988516023431375e-01, -6.5557609890826818e-01, -6.6124947156520919e-01, -6.6690688212287530e-01, -6.7254991170593093e-01, -6.7818011989267801e-01, -6.8379904575907480e-01, -6.8940820874997244e-01, -6.9500910933739291e-01, -7.0060322943341014e-01, -7.0619203255696572e-01, -7.1177696370396137e-01, -7.1735944890025860e-01, -7.2294089436023157e-01, -7.2852268525122998e-01, -7.3410618391359317e-01, -7.3969272755477777e-01, -7.4528362523249903e-01, -7.5088015407681974e-01, -7.5648355456706418e-01, -7.6209502471538959e-01, -7.6771571297655394e-01, -7.7334670959231089e-01, -7.7898903610565784e-01, -7.8464363268161086e-01, -7.9031134278694060e-01, -7.9599289471580259e-01, -8.0168887922298904e-01, -8.0739972260034110e-01, -8.1312565401411607e-01, -8.1886666599105939e-01, -8.2462246644715453e-01, -8.3039242029038418e-01, -8.3617547821719629e-01, -8.4197008959551933e-01, -8.4777409561081263e-01, -8.5358459779500728e-01, -8.5939779589760690e-01, -8.6520878760776276e-01, -8.7101132105143098e-01, -8.7679748971420657e-01, -8.8255735929618218e-01, -8.8827851972919247e-01, -8.9394557014722809e-01, -8.9953958954544189e-01, -9.0503776864304830e-01, -9.1041082246351190e-01, -9.1571070212933903e-01, -9.2080907212653451e-01, -9.2555239796951272e-01, -9.2980950864691880e-01, -9.3341606077604322e-01, -9.3615946593358146e-01, -9.3775577603830218e-01, -9.3781398679012085e-01, -9.3577577607347284e-01, -9.3080547251192991e-01, -9.2152535017774206e-01, -9.0640044624113747e-01, -8.7101066294117024e-01, -7.3951175723211149e-01, -7.7257246658515832e-01, -8.6554338611431003e-01, -1.1440001754521749e+00, -2.8624838944862296e+00, -4.3975453763916752e+00, -5.3295215756516736e+00, -5.9450988416716193e+00, -6.3890444530604027e+00, -6.7291881605577144e+00, -7.0006975184811688e+00, -7.2237473788478113e+00, -7.4108954124366084e+00, -7.5704681409769856e+00, -7.7082637321101579e+00, -7.8284779373040347e+00, -7.9342413432922783e+00, -8.0279478674706901e+00, -8.1114638861701849e+00, -8.1862645540269217e+00, -8.2535359137264290e+00, -8.2917047017681202e+00, -8.3321263444821643e+00, -8.3692779629043077e+00, -8.4035521941689932e+00, -8.4352743608159990e+00, -8.4647200292321934e+00, -8.4921248642385994e+00, -8.5176919963178701e+00, -8.5415977049541070e+00, -8.5639958802063791e+00, -8.5850215866208206e+00, -8.6047939444506394e+00, -8.6234184588237675e+00, -8.6409890031462950e+00, -8.6575893414464478e+00, -8.6732945367836418e+00, -8.6881721216716699e+00, -8.7022828796688874e+00, -8.7156818004115681e+00, -8.7284187336182608e+00, -8.7405389844586843e+00, -8.7520838254252027e+00, -8.7630909397229768e+00, -8.7735948067369716e+00, -8.7836270383192119e+00, -8.7932166730686756e+00, -8.8023904346813353e+00, -8.8111729594955239e+00, -8.8195869974141345e+00, -8.8276535898075057e+00, -8.8353922275522496e+00, -8.8428209915755627e+00, -8.8499566783926351e+00, -8.8568149122689803e+00, -8.8634102457586206e+00, -8.8697562500663309e+00, -8.8758655962834609e+00, -8.8817501286779628e+00, -8.8874209309009711e+00, -8.8928883859159384e+00, -8.8981622302479124e+00, -8.9032516033873321e+00, -8.9081650925781091e+00, -8.9129107736935005e+00, -8.9174962485280886e+00, -8.9219286788345276e+00, -8.9262148174906972e+00, -8.9303610370200115e+00, -8.9343733558033289e+00, -8.9382574621024684e+00, -8.9420187361981469e+00, -8.9456622707020585e+00, -8.9491928894095434e+00, -8.9526151645029941e+00, -8.9559334326790125e+00, -8.9591518098486045e+00, -8.9622742048627995e+00, -8.9653043322296071e+00, -8.9682457238197539e+00, -8.9711017399092032e+00, -8.9738755792288600e+00, -8.9765702884524945e+00, -8.9791887710081557e+00, -8.9817337952497986e+00, -8.9842080021045909e+00, -8.9866139122171838e+00, -8.9889539326030423e+00, -8.9912303628403283e+00, -8.9934454009434077e+00, -8.9956011488014624e+00, -8.9976996172564370e+00, -8.9997427309140647e+00, -9.0017323326602803e+00, -9.0036701877894103e+00, -9.0055579880498193e+00, -9.0073973553428104e+00, -9.0091898451851762e+00, -9.0109369500369603e+00, -9.0126401024012335e+00, -9.0143006777107519e+00, -9.0159199971347519e+00, -9.0174993301188611e+00, -9.0190398968989101e+00, -9.0205428707369215e+00, -9.0220093801717631e+00, -9.0234405110421037e+00, -9.0248373084984852e+00, -9.0262007787736032e+00, -9.0275318909915772e+00, -9.0288315787894433e+00, -9.0301007419177406e+00, -9.0313402477019391e+00, -9.0325509324654778e+00, -9.0337336028623216e+00, -9.0348890371536754e+00, -9.0360179864237988e+00, -9.0371211756950522e+00, -9.0381993050384715e+00, -9.0392530506357893e+00, -9.0402830657028144e+00, -9.0412899814627234e+00, -9.0422744080516839e+00, -9.0432369353238364e+00, -9.0441781337206297e+00, -9.0450985549695950e+00, -9.0459987328902152e+00, -9.0468791840199607e+00, -9.0477404083657778e+00, -9.0485828899593574e+00, -9.0494070975456964e+00, -9.0502134850720957e+00, -9.0510024923320973e+00, -9.0517745454506375e+00, -9.0525300573788048e+00, -9.0532694284122925e+00, -9.0539930466268643e+00, -9.0547012883397944e+00, -9.0553945185303650e+00, -9.0560730912227960e+00, -9.0567373499159203e+00, -9.0573876279246761e+00, -9.0580242487263920e+00, -9.0586475263440569e+00, -9.0592577656518944e+00, -9.0598552626535529e+00, -9.0604403048504327e+00, -9.0610131714925490e+00, -9.0615741338280049e+00, -9.0621234554398775e+00, -9.0626613924325898e+00, -9.0631881937116940e+00, -9.0637041012248591e+00, -9.0642093501648500e+00, -9.0647041691771264e+00, -9.0651887806291942e+00, -9.0656634007503651e+00, -9.0661282398405181e+00, -9.0665835024309978e+00, -9.0670293875688746e+00, -9.0674660888366496e+00, -9.0678937946285512e+00, -9.0683126882566363e+00, -9.0687229481280767e+00, -9.0691247478849331e+00, -9.0695182565236934e+00, -9.0699036385641207e+00, -9.0702810542488610e+00, -9.0706506594389591e+00, -9.0710126059813625e+00, -9.0713670417337173e+00, -9.0717141106626098e+00, -9.0720539529513591e+00, -9.0723867051559477e+00, -9.0727125002379374e+00, -9.0730314677371098e+00, -9.0733437337968716e+00, -9.0736494212866141e+00, -9.0739486498980622e+00, -9.0742415362260029e+00, -9.0745281938401448e+00, -9.0748087333644580e+00, -9.0750832625618258e+00, -9.0753518864035154e+00, -9.0756147071668316e+00, -9.0758718244285905e+00, -9.0761233352395809e+00, -9.0763693340971496e+00, -9.0766099130417217e+00, -9.0768451617579036e+00, -9.0770751675071004e+00, -9.0773000153753038e+00, -9.0775197881545218e+00, -9.0777345664598261e+00, -9.0779444288180766e+00, -9.0781494516299635e+00, -9.0783497093214773e+00, -9.0785452742922228e+00, -9.0787362170385499e+00, -9.0789226061224895e+00, -9.0791045082787196e+00, -9.0792819884074039e+00, -9.0794551096518195e+00, -9.0796239334088149e+00, -9.0797885193490515e+00, -9.0799489255021744e+00, -9.0801052082446372e+00, -9.0802574223676888e+00, -9.0804056210648021e+00, -9.0805498560057956e+00, -9.0806901773437385e+00, -9.0808266337454295e+00, -9.0809592724114108e+00, -9.0810881391256206e+00, -9.0812132782637978e+00, -9.0813347327833256e+00, -9.0814525443513610e+00, -9.0815667532338811e+00, -9.0816773984236310e+00, -9.0817845175955974e+00, -9.0818881471679500e+00, -9.0819883223014859e+00, -9.0820850769055941e+00, -9.0821784436867521e+00, -9.0822684541587115e+00, -9.0823551386364532e+00, -9.0824385262810896e+00, -9.0825186450815121e+00, -9.0825955219117542e+00, -9.0826691824943069e+00, -9.0827396514500531e+00, -9.0828069523535166e+00, -9.0828711076014059e+00, -9.0829321385677417e+00, -9.0829900655583469e+00, -9.0830449078327753e+00, -9.0830966835786064e+00, -9.0831454099777993e+00, -9.0831911031729344e+00, -9.0832337782783270e+00, -9.0832734494211014e+00, -9.0833101297024506e+00, -9.0833438312401533e+00, -9.0833745651515070e+00, -9.0834023415870053e+00, -9.0834271696897968e+00, -9.0834490576504852e+00, -9.0834680126582548e+00, -9.0834840409808564e+00, -9.0834971478743736e+00, -9.0835073376589648e+00, -9.0835146136779059e+00, -9.0835189783508827e+00, -9.0835204330369592e+00]
const BAE_τz      = [3.5654860493670434e+01, +3.5258229980444398e+01, +3.4072109540700183e+01, +3.2114782437349454e+01, +2.9452608161042409e+01, +2.6751705187317391e+01, +2.6312112181532093e+01, +2.6354125567181665e+01, +2.6389871675450934e+01, +2.6417918723568246e+01, +2.6442175768883008e+01, +2.6463902671264982e+01, +2.6483605383836434e+01, +2.6501632856356970e+01, +2.6518254231726313e+01, +2.6533677899148138e+01, +2.6548068304365049e+01, +2.6561557957556602e+01, +2.6574255432477322e+01, +2.6586250905921052e+01, +2.6597620141463786e+01, +2.6608427429668723e+01, +2.6618727803764305e+01, +2.6628568739229703e+01, +2.6637991477457319e+01, +2.6647032070375264e+01, +2.6655722214481571e+01, +2.6664089923653844e+01, +2.6672160076974887e+01, +2.6679954868544996e+01, +2.6687494179662838e+01, +2.6694795888930095e+01, +2.6701876132323903e+01, +2.6708749522608599e+01, +2.6715429335477904e+01, +2.6721927668306829e+01, +2.6728255576176984e+01, +2.6734423188988782e+01, +2.6740439812708978e+01, +2.6746314017255198e+01, +2.6752053713080823e+01, +2.6757666218159436e+01, +2.6763158316758791e+01, +2.6768536311179233e+01, +2.6773806067469764e+01, +2.6778973055909528e+01, +2.6784042386958475e+01, +2.6789018843294084e+01, +2.6793906908415465e+01, +2.6798710792238055e+01, +2.6803434454083796e+01, +2.6808081623331866e+01, +2.6812655818054431e+01, +2.6817160361829941e+01, +2.6821598398981486e+01, +2.6825972908368716e+01, +2.6830286715945391e+01, +2.6834542506174085e+01, +2.6838742832437646e+01, +2.6842890126528083e+01, +2.6846986707372018e+01, +2.6851034788977973e+01, +2.6855036487755871e+01, +2.6858993829227309e+01, +2.6862908754202444e+01, +2.6866783124489960e+01, +2.6870618728118458e+01, +2.6874417284208388e+01, +2.6878180447441249e+01, +2.6881909812209575e+01, +2.6885606916445028e+01, +2.6889273245186157e+01, +2.6892910233862555e+01, +2.6896519271359956e+01, +2.6900101702850389e+01, +2.6903658832413434e+01, +2.6907191925480731e+01, +2.6910702211085493e+01, +2.6914190883946045e+01, +2.6917659106391660e+01, +2.6921108010132841e+01, +2.6924538697881633e+01, +2.6927952244839695e+01, +2.6931349700031092e+01, +2.6934732087518288e+01, +2.6938100407459604e+01, +2.6941455637053416e+01, +2.6944798731324060e+01, +2.6948130623776528e+01, +2.6951452226894187e+01, +2.6954764432494411e+01, +2.6958068111894210e+01, +2.6961364115913465e+01, +2.6964653274684409e+01, +2.6967936397247275e+01, +2.6971214270895761e+01, +2.6974487660283827e+01, +2.6977757306226145e+01, +2.6981023924175460e+01, +2.6984288202314513e+01, +2.6987550799244879e+01, +2.6990812341156033e+01, +2.6994073418475420e+01, +2.6997334581833815e+01, +2.7000596337314192e+01, +2.7003859140811766e+01, +2.7007123391399794e+01, +2.7010389423513914e+01, +2.7013657497728627e+01, +2.7016927789924040e+01, +2.7020200378523089e+01, +2.7023475229443491e+01, +2.7026752178340889e+01, +2.7030030909593396e+01, +2.7033310931477299e+01, +2.7036591546578329e+01, +2.7039871816676381e+01, +2.7043150520750139e+01, +2.7046426104662480e+01, +2.7049696620700509e+01, +2.7052959654503454e+01, +2.7056212236461686e+01, +2.7059450733635742e+01, +2.7062670717239016e+01, +2.7065866799042038e+01, +2.7069032427932004e+01, +2.7072159634816011e+01, +2.7075238709617253e+01, +2.7078257787702327e+01, +2.7081202313342160e+01, +2.7084054332676018e+01, +2.7086791543897007e+01, +2.7089385989641496e+01, +2.7091802300553283e+01, +2.7269596711055513e+01, +2.7534466463544351e+01, +2.7798498809814134e+01, +2.8061680466237238e+01, +2.8324002318632456e+01, +2.8585457083491384e+01, +2.8846035226122275e+01, +2.9105717382487583e+01, +2.9364462018260525e+01, +2.9622192590568009e+01, +2.9878822333600834e+01, +3.0136897007178622e+01, +3.0433598569777800e+01, +3.3400800836098249e+01, +3.8109462404266253e+01, +4.2146916238287247e+01, +4.4697738584877818e+01, +4.2007663116840078e+01, +3.8941920610592959e+01, +3.7016318787839303e+01, +3.5695341289061368e+01, +3.4699391083785009e+01, +3.3897547574338695e+01, +3.3222452322145813e+01, +3.2635866899844764e+01, +3.2114261327385705e+01, +3.1642212056427876e+01, +3.1209097344233861e+01, +3.0807311240862646e+01, +3.0431234354955311e+01, +3.0076609230582722e+01, +2.9740146055889429e+01, +2.9419268729727698e+01, +2.9111926670883410e+01, +2.9040718105679154e+01, +2.8923896338487332e+01, +2.8816211568565542e+01, +2.8716586261434301e+01, +2.8624121826509306e+01, +2.8538055166236941e+01, +2.8457732463243197e+01, +2.8382589325801764e+01, +2.8312135422456361e+01, +2.8245942251531417e+01, +2.8183633400558833e+01, +2.8124876650940333e+01, +2.8069377502711976e+01, +2.8016873762603343e+01, +2.7967131274064783e+01, +2.7919940059921448e+01, +2.7875111155496967e+01, +2.7832474256865172e+01, +2.7791875222080350e+01, +2.7753174214990953e+01, +2.7716244052737366e+01, +2.7680968784763589e+01, +2.7647242461679081e+01, +2.7614968064706918e+01, +2.7584056571486339e+01, +2.7554426138374282e+01, +2.7526001382417743e+01, +2.7498712748783650e+01, +2.7472495952082635e+01, +2.7447291481581676e+01, +2.7423044161555939e+01, +2.7399702760229712e+01, +2.7377219640374026e+01, +2.7355550447066900e+01, +2.7334653827734495e+01, +2.7314491180466661e+01, +2.7295026427687123e+01, +2.7276225811910560e+01, +2.7258057711182239e+01, +2.7240492471965187e+01, +2.7223502257832120e+01, +2.7207060911604682e+01, +2.7191143830366148e+01, +2.7175727851320964e+01, +2.7160791147644208e+01, +2.7146313133385263e+01, +2.7132274376355515e+01, +2.7118656518388857e+01, +2.7105442202020509e+01, +2.7092615003268303e+01, +2.7080159369668358e+01, +2.7068060563380733e+01, +2.7056304608380522e+01, +2.7044878242242586e+01, +2.7033768870912613e+01, +2.7022964527477445e+01, +2.7012453833640031e+01, +2.7002225964012190e+01, +2.6992270613235938e+01, +2.6982577964939033e+01, +2.6973138663486264e+01, +2.6963943787281956e+01, +2.6954984823968928e+01, +2.6946253647415570e+01, +2.6937742496168536e+01, +2.6929443953309942e+01, +2.6921350927691314e+01, +2.6913456636459451e+01, +2.6905754588467030e+01, +2.6898238568906006e+01, +2.6890902624953046e+01, +2.6883741052157827e+01, +2.6876748381656199e+01, +2.6869919368487970e+01, +2.6863248980116119e+01, +2.6856732385946462e+01, +2.6850364947501021e+01, +2.6844142208966321e+01, +2.6838059888384937e+01, +2.6832113869450033e+01, +2.6826300193516591e+01, +2.6820615052370243e+01, +2.6815054781066362e+01, +2.6809615851550415e+01, +2.6804294866240117e+01, +2.6799088552247166e+01, +2.6793993755626996e+01, +2.6789007436318318e+01, +2.6784126662963100e+01, +2.6779348608263156e+01, +2.6774670544393771e+01, +2.6770089838810041e+01, +2.6765603950164365e+01, +2.6761210424473607e+01, +2.6756906891453159e+01, +2.6752691061013561e+01, +2.6748560720054311e+01, +2.6744513729259019e+01, +2.6740548020034066e+01, +2.6736661591839905e+01, +2.6732852509382777e+01, +2.6729118899992866e+01, +2.6725458951295753e+01, +2.6721870908692452e+01, +2.6718353073335766e+01, +2.6714903799791312e+01, +2.6711521494215781e+01, +2.6708204612178040e+01, +2.6704951657039761e+01, +2.6701761177953401e+01, +2.6698631768431337e+01, +2.6695562064475492e+01, +2.6692550743153756e+01, +2.6689596521157053e+01, +2.6686698153286645e+01, +2.6683854431170367e+01, +2.6681064181917488e+01, +2.6678326266885897e+01, +2.6675639580552946e+01, +2.6673003049258337e+01, +2.6670415630197041e+01, +2.6667876310397286e+01, +2.6665384105600950e+01, +2.6662938059352715e+01, +2.6660537242181285e+01, +2.6658180750515275e+01, +2.6655867705939919e+01, +2.6653597254454702e+01, +2.6651368565482009e+01, +2.6649180831310055e+01, +2.6647033266263207e+01, +2.6644925105989842e+01, +2.6642855606855715e+01, +2.6640824045323235e+01, +2.6638829717159055e+01, +2.6636871937010270e+01, +2.6634950037784339e+01, +2.6633063370151618e+01, +2.6631211301744308e+01, +2.6629393217037315e+01, +2.6627608516561537e+01, +2.6625856616572126e+01, +2.6624136948515300e+01, +2.6622448958616328e+01, +2.6620792107512575e+01, +2.6619165869744606e+01, +2.6617569733197339e+01, +2.6616003199319653e+01, +2.6614465782113506e+01, +2.6612957008014789e+01, +2.6611476415600912e+01, +2.6610023555267038e+01, +2.6608597988757460e+01, +2.6607199289063274e+01, +2.6605827039901033e+01, +2.6604480835634273e+01, +2.6603160280901793e+01, +2.6601864990329766e+01, +2.6600594588282100e+01, +2.6599348708645572e+01, +2.6598126994583573e+01, +2.6596929098283503e+01, +2.6595754680741901e+01, +2.6594603411473631e+01, +2.6593474968516205e+01, +2.6592369037917965e+01, +2.6591285313804249e+01, +2.6590223498091806e+01, +2.6589183300181841e+01, +2.6588164437146705e+01, +2.6587166633009094e+01, +2.6586189619065394e+01, +2.6585233133545753e+01, +2.6584296921347132e+01, +2.6583380734132923e+01, +2.6582484329888626e+01, +2.6581607473058753e+01, +2.6580749934188255e+01, +2.6579911489998224e+01, +2.6579091923077591e+01, +2.6578291021886987e+01, +2.6577508580532729e+01, +2.6576744398726344e+01, +2.6575998281721603e+01, +2.6575270040061433e+01, +2.6574559489601807e+01, +2.6573866451315972e+01, +2.6573190751319004e+01, +2.6572532220649972e+01, +2.6571890695244448e+01, +2.6571266015842184e+01, +2.6570658027922981e+01, +2.6570066581557775e+01, +2.6569491531377029e+01, +2.6568932736603923e+01, +2.6568390060661457e+01, +2.6567863371504416e+01, +2.6567352541240563e+01, +2.6566857446251152e+01, +2.6566377967012890e+01, +2.6565913988099076e+01, +2.6565465398142543e+01, +2.6565032089719914e+01, +2.6564613959290899e+01, +2.6564210907225132e+01, +2.6563822837666873e+01, +2.6563449658585718e+01, +2.6563091281604244e+01, +2.6562747622103753e+01, +2.6562418599076228e+01, +2.6562104134961331e+01, +2.6561804156024504e+01, +2.6561518591902008e+01, +2.6561247375738933e+01, +2.6560990444113489e+01, +2.6560747737114074e+01, +2.6560519198145336e+01, +2.6560304774022750e+01, +2.6560104414939435e+01, +2.6559918074342900e+01, +2.6559745709050112e+01, +2.6559587279118336e+01, +2.6559442747896757e+01, +2.6559312081924837e+01, +2.6559195251051687e+01, +2.6559092228271684e+01, +2.6559002989870663e+01, +2.6558927515189907e+01, +2.6558865786886031e+01, +2.6558817790713622e+01, +2.6558783515642556e+01, +2.6558762953699521e+01, +2.6558756100387519e+01]
const BAE_θ_log10 = [3.1635712823620779e+00, +2.9318135408973367e+00, +2.2397184864210953e+00, +1.1000120534374469e+00, -4.4543185250227935e-01, -1.9981352981036153e+00, -2.1986709408976970e+00, -2.1280184637560469e+00, -2.0723381559952987e+00, -2.0267110558818642e+00, -1.9866347878751542e+00, -1.9505682956056216e+00, -1.9177502813137275e+00, -1.8876311879875209e+00, -1.8597889628383282e+00, -1.8338951766482039e+00, -1.8096887687291610e+00, -1.7869581467177063e+00, -1.7655291239274946e+00, -1.7452564516156606e+00, -1.7260176754952601e+00, -1.7077085696402983e+00, -1.6902396747503952e+00, -1.6735336290098415e+00, -1.6575230800029175e+00, -1.6421490304052990e+00, -1.6273595126254656e+00, -1.6131085163555088e+00, -1.5993551129404564e+00, -1.5860627346051890e+00, -1.5731985767171899e+00, -1.5607330986818313e+00, -1.5486396045566320e+00, -1.5368938885827739e+00, -1.5254739339475083e+00, -1.5143596554767105e+00, -1.5035326788039476e+00, -1.4929761499894827e+00, -1.4826745707013704e+00, -1.4726136549540423e+00, -1.4627802041171696e+00, -1.4531619974731280e+00, -1.4437476960656375e+00, -1.4345267579526535e+00, -1.4254893632785257e+00, -1.4166263478384669e+00, -1.4079291440039976e+00, -1.3993897280560861e+00, -1.3910005731076018e+00, -1.3827546069206711e+00, -1.3746451740233423e+00, -1.3666660016004313e+00, -1.3588111687302296e+00, -1.3510750785684804e+00, -1.3434524331490236e+00, -1.3359382105180886e+00, -1.3285276439328459e+00, -1.3212162029182331e+00, -1.3139995759726315e+00, -1.3068736547638444e+00, -1.2998345196499470e+00, -1.2928784264059996e+00, -1.2860017940260100e+00, -1.2792011935048333e+00, -1.2724733374980484e+00, -1.2658150707866822e+00, -1.2592233614640247e+00, -1.2526952927826862e+00, -1.2462280556044760e+00, -1.2398189413983607e+00, -1.2334653357369461e+00, -1.2271647122556470e+00, -1.2209146270290667e+00, -1.2147127133392261e+00, -1.2085566767930664e+00, -1.2024442907795883e+00, -1.1963733922229411e+00, -1.1903418776232777e+00, -1.1843476993639190e+00, -1.1783888622632595e+00, -1.1724634203592432e+00, -1.1665694739218628e+00, -1.1607051666611665e+00, -1.1548686831541333e+00, -1.1490582464510291e+00, -1.1432721158822530e+00, -1.1375085850433435e+00, -1.1317659799742317e+00, -1.1260426575163958e+00, -1.1203370038716711e+00, -1.1146474333464160e+00, -1.1089723873132993e+00, -1.1033103333782743e+00, -1.0976597647949147e+00, -1.0920192001176947e+00, -1.0863871831421976e+00, -1.0807622831470431e+00, -1.0751430954773049e+00, -1.0695282425128103e+00, -1.0639163750710274e+00, -1.0583061743063376e+00, -1.0526963541729908e+00, -1.0470856645515878e+00, -1.0414728951226171e+00, -1.0358568801288706e+00, -1.0302365041599493e+00, -1.0246107091425487e+00, -1.0189785027438265e+00, -1.0133389684391791e+00, -1.0076912775557734e+00, -1.0020347036533968e+00, -9.9636863969104783e-01, -9.9069261852267121e-01, -9.8500633738261500e-01, -9.7930968717155786e-01, -9.7360278753915475e-01, -9.6788602899298959e-01, -9.6216012355899327e-01, -9.5642616589741192e-01, -9.5068570724420143e-01, -9.4494084519314792e-01, -9.3919433307906797e-01, -9.3344971379906982e-01, -9.2771148419531346e-01, -9.2198529787256189e-01, -9.1627821652090424e-01, -9.1059902263379866e-01, -9.0495860993122046e-01, -8.9937047160619099e-01, -8.9385130966791593e-01, -8.8842178771059233e-01, -8.8310743380634138e-01, -8.7793964311403472e-01, -8.7295841990631751e-01, -8.6815744422736973e-01, -8.6365699542685626e-01, -8.5960065192839208e-01, -8.5612993586623487e-01, -8.5342645458549371e-01, -8.5173084158634427e-01, -8.5137238958531714e-01, -8.5281615058578275e-01, -8.5674198286183478e-01, -8.6418234615896439e-01, -8.7681072763146339e-01, -8.9510141058992088e-01, -9.1314290184479741e-01, +5.0959302416841568e-01, +3.1149598768431126e+00, +5.4017392241113971e+00, +7.0496492058420568e+00, +7.4027081526535783e+00, +7.4163446827596822e+00, +7.4244168065018235e+00, +7.4314208848002128e+00, +7.4375880005096828e+00, +7.4430045781945831e+00, +7.4477379153706664e+00, +7.4518478950805278e+00, +7.4553890955699238e+00, +7.4584114350509942e+00, +7.4609604412936559e+00, +7.4630773897202403e+00, +7.4647992747331688e+00, +7.4661585538493282e+00, +7.4671824199270338e+00, +7.4678911000896928e+00, +7.4683014028561914e+00, +7.4681467078784731e+00, +7.4678693805917531e+00, +7.4674328761459190e+00, +7.4668676333937070e+00, +7.4661955193250797e+00, +7.4654339325092298e+00, +7.4645970486109263e+00, +7.4636966021514288e+00, +7.4627424612765481e+00, +7.4617429815338285e+00, +7.4607053053563979e+00, +7.4596355922275821e+00, +7.4585391510815890e+00, +7.4574206121411830e+00, +7.4562839915901984e+00, +7.4551328052898329e+00, +7.4539701856747858e+00, +7.4527988226018032e+00, +7.4516211081360781e+00, +7.4504391517165311e+00, +7.4492548155405363e+00, +7.4480697448465145e+00, +7.4468853939954869e+00, +7.4457030490031189e+00, +7.4445238470627402e+00, +7.4433487935158853e+00, +7.4421787766551581e+00, +7.4410145806708492e+00, +7.4398568970146286e+00, +7.4387063343930979e+00, +7.4375634275835099e+00, +7.4364286452278741e+00, +7.4353023967372724e+00, +7.4341850384237409e+00, +7.4330768789511419e+00, +7.4319781841986838e+00, +7.4308891815955525e+00, +7.4298100640021945e+00, +7.4287409931832427e+00, +7.4276821029211550e+00, +7.4266335018153153e+00, +7.4255952757921655e+00, +7.4245674903769228e+00, +7.4235501927259655e+00, +7.4225434134707644e+00, +7.4215471683793925e+00, +7.4205614598586074e+00, +7.4195862783137807e+00, +7.4186216033781136e+00, +7.4176674050281992e+00, +7.4167236445995801e+00, +7.4157902756949889e+00, +7.4148672450260067e+00, +7.4139544931658712e+00, +7.4130519552378749e+00, +7.4121595615412215e+00, +7.4112772381187959e+00, +7.4104049072754785e+00, +7.4095424880490066e+00, +7.4086898966375916e+00, +7.4078470467917370e+00, +7.4070138501680445e+00, +7.4061902166535827e+00, +7.4053760546594569e+00, +7.4045712713891358e+00, +7.4037757730816907e+00, +7.4029894652340289e+00, +7.4022122528021255e+00, +7.4014440403839705e+00, +7.4006847323857565e+00, +7.3999342331729521e+00, +7.3991924472067154e+00, +7.3984592791669090e+00, +7.3977346340677155e+00, +7.3970184173523359e+00, +7.3963105349890768e+00, +7.3956108935520710e+00, +7.3949194002944454e+00, +7.3942359632140180e+00, +7.3935604911129209e+00, +7.3928928936496314e+00, +7.3922330813848793e+00, +7.3915809658247449e+00, +7.3909364594531173e+00, +7.3902994757664517e+00, +7.3896699292994281e+00, +7.3890477356486528e+00, +7.3884328114928266e+00, +7.3878250746086609e+00, +7.3872244438845458e+00, +7.3866308393324216e+00, +7.3860441820951026e+00, +7.3854643944540017e+00, +7.3848913998306092e+00, +7.3843251227915747e+00, +7.3837654890463735e+00, +7.3832124254491527e+00, +7.3826658599939101e+00, +7.3821257218117982e+00, +7.3815919411647899e+00, +7.3810644494416477e+00, +7.3805431791490879e+00, +7.3800280639050628e+00, +7.3795190384284561e+00, +7.3790160385318631e+00, +7.3785190011103232e+00, +7.3780278641298125e+00, +7.3775425666180174e+00, +7.3770630486520758e+00, +7.3765892513468589e+00, +7.3761211168414613e+00, +7.3756585882893306e+00, +7.3752016098425406e+00, +7.3747501266408397e+00, +7.3743040847997943e+00, +7.3738634313931959e+00, +7.3734281144431941e+00, +7.3729980829072996e+00, +7.3725732866626776e+00, +7.3721536764943956e+00, +7.3717392040813978e+00, +7.3713298219818313e+00, +7.3709254836235054e+00, +7.3705261432857831e+00, +7.3701317560890711e+00, +7.3697422779809401e+00, +7.3693576657238351e+00, +7.3689778768809822e+00, +7.3686028698038104e+00, +7.3682326036199939e+00, +7.3678670382193410e+00, +7.3675061342430261e+00, +7.3671498530706696e+00, +7.3667981568068619e+00, +7.3664510082712304e+00, +7.3661083709859874e+00, +7.3657702091647810e+00, +7.3654364876928105e+00, +7.3651071721367378e+00, +7.3647822287085187e+00, +7.3644616242703851e+00, +7.3641453263195293e+00, +7.3638333029748839e+00, +7.3635255229714653e+00, +7.3632219556471439e+00, +7.3629225709293333e+00, +7.3626273393441064e+00, +7.3623362319692154e+00, +7.3620492204612056e+00, +7.3617662770277805e+00, +7.3614873744222074e+00, +7.3612124859354884e+00, +7.3609415853848743e+00, +7.3606746471094890e+00, +7.3604116459561659e+00, +7.3601525572763435e+00, +7.3598973569147583e+00, +7.3596460212033170e+00, +7.3593985269510878e+00, +7.3591548514396399e+00, +7.3589149724127116e+00, +7.3586788680709754e+00, +7.3584465170634310e+00, +7.3582178984817670e+00, +7.3579929918519609e+00, +7.3577717771286988e+00, +7.3575542346879921e+00, +7.3573403453226600e+00, +7.3571300902331132e+00, +7.3569234510231460e+00, +7.3567204096955061e+00, +7.3565209486415464e+00, +7.3563250506394509e+00, +7.3561326988475324e+00, +7.3559438767986514e+00, +7.3557585683953723e+00, +7.3555767579031039e+00, +7.3553984299476829e+00, +7.3552235695074284e+00, +7.3550521619129068e+00, +7.3548841928372042e+00, +7.3547196482944761e+00, +7.3545585146338874e+00, +7.3544007785369336e+00, +7.3542464270128018e+00, +7.3540954473919307e+00, +7.3539478273259640e+00, +7.3538035547810141e+00, +7.3536626180350417e+00, +7.3535250056734487e+00, +7.3533907065864561e+00, +7.3532597099652577e+00, +7.3531320052986082e+00, +7.3530075823684822e+00, +7.3528864312523901e+00, +7.3527685423094180e+00, +7.3526539061875100e+00, +7.3525425138173865e+00, +7.3524343564081045e+00, +7.3523294254455420e+00, +7.3522277126921169e+00, +7.3521292101752804e+00, +7.3520339102013379e+00, +7.3519418053372174e+00, +7.3518528884160119e+00, +7.3517671525334070e+00, +7.3516845910464994e+00, +7.3516051975695804e+00, +7.3515289659742100e+00, +7.3514558903867577e+00, +7.3513859651860516e+00, +7.3513191850032689e+00, +7.3512555447169863e+00, +7.3511950394572958e+00, +7.3511376645984683e+00, +7.3510834157607663e+00, +7.3510322888087209e+00, +7.3509842798496470e+00, +7.3509393852329250e+00, +7.3508976015471079e+00, +7.3508589256219867e+00, +7.3508233545246400e+00, +7.3507908855609028e+00, +7.3507615162726259e+00, +7.3507352444392442e+00, +7.3507120680739080e+00, +7.3506919854266739e+00, +7.3506749949811736e+00, +7.3506610954547016e+00, +7.3506502857985829e+00, +7.3506425651978420e+00, +7.3506379330682750e+00, +7.3506363890709583e+00]
#}}}
const BAE_θ = 10 .^ BAE_θ_log10
const BAE_V = 10 .^ BAE_V_log10
do_plotting = false
if VERSION < v"0.6.999999"
  macro isdefined(s::Symbol)
    return isdefined(s)
  end
end
if !@isdefined mtime_global_curved
  mtime_global_curved = 0
end
if mtime_global_curved < mtime("global_curved.jl")
  println("including global_curved")
  include("global_curved.jl")
  mtime_global_curved = mtime("global_curved.jl")
end
if VERSION < v"0.6.999999"
  macro isdefined(s::Symbol)
    return isdefined(s)
  end
end
if !@isdefined mtime_global_curved
  mtime_global_curved = 0
end
if VERSION <= v"0.6.999999"
  ldiv! = A_ldiv_B!
  cholesky = cholfact
  using CholmodSolve2
end

using DifferentialEquations
using Compat.Printf: @sprintf

let
  RS_FAULT = 7
  VP_FAULT = 8
  sim_years = 3000.
  year_seconds = 31556926.
  SBPp   = 2 # SBP interior order

  Ly = Lx = 36
  verts = ((-Lx,   0), (0,   0), (Lx,   0), # 1 2 3
           (-Lx, -Ly), (0, -Ly), (Lx, -Ly)) # 4 5 6
  EToV = ((5, 2, 4, 1),
          (6, 3, 5, 2))
  EToF = ((1,  2,  3, 4),
          (5,  6,  7, 3))
  FToB = fill(BC_LOCKED_INTERFACE, (7,))
  EToBlock = (1,2)
  for f ∈ (4, 7)
    FToB[f] = BC_DIRICHLET
  end
  for f ∈ (3,)
    FToB[f] = BC_JUMP_INTERFACE
    FToB[f] = RS_FAULT
  end
  for f ∈ (1,2,5,6,)
    FToB[f] = BC_NEUMANN
  end
  N0 = 400
  N1 = 400
  @show (N0,N1)
  lvl = 1 # Refinement
  τscale = 12
  base_name = "compare_BP1_2block_SBPp$(SBPp)_ptsc$(τscale)_lvl$(lvl)_Lx$(Lx)"

  if typeof(verts) <: Tuple
    verts = flatten_tuples(verts)
    EToV  = flatten_tuples(EToV)
    EToF  = flatten_tuples(EToF)
  end

  # number of elements and faces
  (nelems, nfaces) = (size(EToV, 2), size(FToB, 1))
  @show (nelems, nfaces)

  EToN0 = zeros(Int64, 2, nelems)
  EToN0[1, :] .= N0
  EToN0[2, :] .= N1

  #=
  @plotting (p1, p2, p3) = (plot(), plot(), plot())
  @plotting let
    # Do some plotting
    scatter!(p1, verts[1,:], verts[2,:], marker=1, legend=:none)
    display(plot!(p1, aspect_ratio = 1))
    for e = 1:nelems
      V = EToV[:, e]
      plot!(p1, verts[1, V], verts[2, V], linewidth=3)
    end
    display(plot!(p1, aspect_ratio = 1))
  end
  =#

  # Some sanity checks
  @assert typeof(EToV) == Array{Int, 2} && size(EToV) == (4, nelems)
  @assert typeof(EToF) == Array{Int, 2} && size(EToF) == (4, nelems)
  @assert maximum(maximum(EToF)) == nfaces

  # Determine secondary arrays
  # FToE : Unique Global Face to Element Number
  # FToLF: Unique Global Face to Element local face number
  # EToO : Element to Unique Global Faces Orientation
  # EToS : Element to Unique Global Face Side
  (FToE, FToLF, EToO, EToS) = connectivityarrays(EToV, EToF)

  #{{{ Plot the connectivity using vertices corners
  @plotting (p1, p2, p3) = (plot(), plot(), plot())
  @plotting let
    # Do some plotting
    scatter!(p1, verts[1,:], verts[2,:], marker=1, legend=:none)
    LFToLV = flatten_tuples(((1,3), (2, 4), (1,2), (3,4)))
    for f = 1:nfaces
      e  = FToE[1,f]
      lf = FToLF[1,f]
      V = EToV[LFToLV[:,lf], e]
      if FToB[f] == BC_DIRICHLET
        plot!(p1, verts[1, V], verts[2, V], color=:red, linewidth=3)
      elseif FToB[f] == BC_NEUMANN
        plot!(p1, verts[1, V], verts[2, V], color=:blue, linewidth=3)
      elseif FToB[f] == BC_LOCKED_INTERFACE
        plot!(p1, verts[1, V], verts[2, V], color=:black, linewidth=1)
      elseif FToB[f] >= BC_JUMP_INTERFACE
        plot!(p1, verts[1, V], verts[2, V], color=:green, linewidth=3)
      else
        error("invalid bc")
      end
    end
    plot!(p1, aspect_ratio = 1)
    display(plot!(p1, aspect_ratio = 1))
  end
  #}}}


  # Set up the local grid dimensions
  Nr = EToN0[1, :] * (2^(lvl-1))
  Ns = EToN0[2, :] * (2^(lvl-1))

  #{{{ Build the local volume operators
  # Dictionary to store the operators
  OPTYPE = typeof(locoperator(2, 8, 8, (r,s)->r, (r,s)->s))
  lop = Dict{Int64, OPTYPE}()
  for e = 1:nelems
    @show (e, nelems)
    # Get the element corners
    (x1, x2, x3, x4) = verts[1, EToV[:, e]]
    (y1, y2, y3, y4) = verts[2, EToV[:, e]]

    xt = (r,s)->transfinite_blend(x1, x2, x3, x4, r, s)
    yt = (r,s)->transfinite_blend(y1, y2, y3, y4, r, s)

    # Build local operators
    lop[e] = locoperator(SBPp, Nr[e], Ns[e], xt, yt, LFToB = FToB[EToF[:, e]],
                         τscale=τscale)
  end
  #}}}

  # Assemble the global volume operators
  (vstarts, M, H, X, Y, E) = glovoloperator(lop, Nr, Ns)

  # Build the trace operators
  (FToλstarts, T, D) = gloλoperator(lop, vstarts, FToB, FToE, FToLF, EToO, EToS,
                                    Nr, Ns)
  λNp = FToλstarts[nfaces+1]-1

  # Get a unique array indexes for the face to jumps map
  FToδstarts = bcstarts(FToB, FToE, FToLF, (RS_FAULT,VP_FAULT), Nr, Ns)

  # Compute the number of volume, trace (λ), and jump (δ) points
  VNp = vstarts[nelems+1]-1
  λNp = FToλstarts[nfaces+1]-1
  δNp = FToδstarts[nfaces+1]-1
  @show (VNp, λNp, δNp)

  A = [ M -T'; -T  Diagonal(D) ]
  AF = cholesky(Symmetric(A))

  # Set up some needed arrays
  (uλ, g) = (zeros(VNp + λNp), zeros(VNp+λNp))
  u = @view uλ[1:VNp]
  λ = @view uλ[VNp+(1:λNp)]

  #{{{ Compute the boundary/interface functions
  Vp = 1e-9
  ulinear(x, y, t) = (x/Lx) * (Vp/2) * t
  bc_Dirichlet = (lf, x, y, e, δ, t) -> ulinear(x,y,t)
  bc_Neumann   = (lf, x, y, nx, ny, e, δ, t) -> zeros(size(x))
  in_jump      = (lf, x, y, e, δ, t) -> begin
    f = EToF[lf, e]
    if EToS[lf, e] == 1
      if EToO[lf, e]
        return -δ[FToδstarts[f]:(FToδstarts[f+1]-1)]
      else
        return -δ[(FToδstarts[f+1]-1):-1:FToδstarts[f]]
      end
    else
      if EToO[lf, e]
        return  δ[FToδstarts[f]:(FToδstarts[f+1]-1)]
      else
        return  δ[(FToδstarts[f+1]-1):-1:FToδstarts[f]]
      end
    end
  end
  #}}}

  #{{{ parameters
  ρ = 2.670
  cs = 3.464
  μshear = cs^2 * ρ
  σn = 50 * ones(δNp)
  η = μshear / (2 * cs)
  RSamin = 0.010
  RSamax = 0.025
  RSb = 0.015
  RSDc = 0.016
  RSf0 = 0.6
  RSV0 = 1e-6
  RSVinit = 1e-9
  RSa = zeros(δNp)
  RSH1 = 12;
  RSH2 = 15;
  fault_y = zeros(δNp)
  for f = 1:nfaces
    if FToB[f] ∈ (RS_FAULT, VP_FAULT)
      (e1, ~) = FToE[:, f]
      (lf1, ~) = FToLF[:, f]
      (~, ~, L, (~, y), ~, ~, ~, ~, ~, ~, ~) = lop[e1]
      fault_y[FToδstarts[f]:(FToδstarts[f+1]-1)] = yf = L[lf1] * y
      δrng = FToδstarts[f]:(FToδstarts[f+1]-1)
      for n = 1:length(δrng)
        RSa[δrng[n]] = RSamin - (RSamin - RSamax) *
          min(1, max(0, (RSH1 + yf[n])/(RSH1 - RSH2)))
      end
    end
  end
  τz0 = σn .* RSamax .* asinh.(RSVinit ./ (2 .* RSV0) .*
                               exp.((RSf0 .+ RSb .* log.(RSV0 ./ RSVinit)) ./
                                    RSamax)) .+ η .* RSVinit

  θ = (RSDc ./ RSV0) .* exp.((RSa ./ RSb) .* log.((2 .* RSV0 ./ RSVinit) .*
      sinh.((τz0 .- η .* RSVinit) ./ (RSa .* σn))) .- RSf0 ./ RSb)
  ψ0 = RSf0 .+ RSb .* log.(RSV0 .* θ ./ RSDc)

  for f = 1:nfaces
    if FToB[f] == RS_FAULT
      (e1, e2) = FToE[:, f]
      (lf1, lf2) = FToLF[:, f]
      (~, ~, ~, ~, ~, ~, nx, ~, ~, ~, ~) = lop[e1]
      δrng = FToδstarts[f]:(FToδstarts[f+1]-1)
      for n = 1:length(δrng)
        τz0[δrng[n]] = sign(nx[lf1][n])*abs(τz0[δrng[n]])
      end
    end
  end
  #}}}

  #{{{ ODE fun
  reject_step = [false]
  # array of jumps
  lockedblock = Array{Bool, 1}(undef, nelems)
  for e = 1:nelems
    if @views FToB[EToF[:,e]] == [BC_LOCKED_INTERFACE, BC_LOCKED_INTERFACE,
                                  BC_LOCKED_INTERFACE, BC_LOCKED_INTERFACE]
      lockedblock[e] = true
    else
      lockedblock[e] = false
    end
  end
  τ = zeros(δNp)
  τp = zeros(δNp)
  τm = zeros(δNp)
  odefun(dψV, ψδ, p, t) = begin
    begin
      if reject_step[1]
        return
      end
      ψ  = @view ψδ[        (1:δNp) ]
      δ  = @view ψδ[ δNp .+ (1:δNp) ]
      dψ = @view dψV[       (1:δNp) ]
      V  = @view dψV[δNp .+ (1:δNp) ]
      for e = 1:nelems
        locbcarray!((@view g[vstarts[e]:vstarts[e+1]-1]), lop[e], FToB[EToF[:,e]],
                    bc_Dirichlet, bc_Neumann, in_jump, (e, δ, t))
      end
      uλ[:] = AF \ g

      # Compute the shear-traction and update velocity
      show_val = false
      for f = 1:nfaces
        if FToB[f] == RS_FAULT
          (e1, e2) = FToE[:, f]
          (lf1, lf2) = FToLF[:, f]
          δrng = FToδstarts[f]:(FToδstarts[f+1]-1)

          (τm[δrng], τp[δrng]) = computeTz5(f, FToλstarts, u, vstarts, lop,
                                            FToE, FToLF, EToO)
          (τm[δrng], τp[δrng]) = (μshear * τm[δrng], μshear * τp[δrng])
          τ[δrng] .= (τm[δrng] .+ τp[δrng]) / 2

          for n = 1:length(δrng)
            δn = δrng[n]
            τ[δn] .= τ[δn] .+ τz0[δn]
            if isnan(τ[δn])
              reject_step[1] = true
              return
            end
            VR = abs(τ[δn] / η)
            VL = -VR
            (Vnew, ~, iter) = newtbndv((V) -> rateandstate(V, ψ[δn], σn[δn],
                                                           τ[δn], η, RSa[δn],
                                                           RSV0),
                                       VL, VR, 0.0; atolx=1e-9, rtolx=1e-9,
                                       ftol=1e-9)
            if show_val
              show_val = false
              @show (ψ[δn], σn[δn], τ[δn], η, RSa[δn], RSV0)
            end
            if isnan(Vnew) || iter < 0
              # @show (VL, VR, V[δn], Vnew, Tz[n], η, RSa[δn], RSV0)
              println("V reject")
              Vnew = 1e10
              reject_step[1] = true
              return
              #error()
            end
            #=
            =#
            #=
            if abs(Vnew) > 100
              @show (Vnew, (VL, VR, V[δn], Tz[n], η, RSa[δn], RSV0))
            end
            =#
            V[δn] = Vnew

            dψ[δn] = (RSb * RSV0 / RSDc) * (exp((RSf0-ψ[δn]) / RSb) - abs(V[δn])
                                            / RSV0)
            if !isfinite(dψ[δn])
              println("ψ reject")
              dψ[δn] = 0
              reject_step[1] = true
              return
            end

          end
        elseif FToB[f] == VP_FAULT
          (e1, ~) = FToE[:, f]
          (lf1, ~) = FToLF[:, f]
          (~, ~, ~, ~, ~, ~, nx, ~, ~, ~, ~) = lop[e1]
          for δn = FToδstarts[f]:(FToδstarts[f+1]-1)
            V[δn] = sign(nx[lf1][1]) * Vp
          end
        end
      end
      # @show (t/year_seconds, extrema(V), extrema(abs.(δ)), extrema(abs.(ψ)), extrema(dψ))
      V
    end
  end
  ψδ = zeros(2 * δNp)
  ψδ[1:δNp] .= ψ0
  dψV = zeros(2 * δNp)
  #}}}

  #{{{ Setup station data
  stations = [0, -2.5, -5, -7.5, -10, -12.5, -15, -17.5, -20, -25, -30]
  numstations = length(stations)
  station_ind = zeros(Int64, numstations)
  station_face = zeros(Int64, numstations)
  for s = 1:numstations
    n = station_ind[s] = argmin(abs.(fault_y-stations[s]))
    f = station_face[s] = findlast((m) -> m <= n, FToδstarts)
    println((stations[s], fault_y[station_ind[s]], FToδstarts[f] <= n < FToδstarts[f+1]))
  end
  station_t = zeros(Float64, ceil(Int64, sim_years)*10)
  station_V = zeros(Float64, numstations, ceil(Int64, sim_years)*10)
  station_τ = zeros(Float64, numstations, ceil(Int64, sim_years)*10)
  station_θ = zeros(Float64, numstations, ceil(Int64, sim_years)*10)
  station_δ = zeros(Float64, numstations, ceil(Int64, sim_years)*10)
  #}}}

  tspan = (0, sim_years * year_seconds)

  dψV = zeros(2 * δNp)
  ψδ[1:δNp] .= RSf0 .+ RSb .* log.(RSV0 .* BAE_θ[end:-1:1] ./ RSDc)
  ψδ[δNp .+ (1:δNp)] .= BAE_δ[end:-1:1]
  odefun(dψV, ψδ, (), BAE_t)
  # @show fault_y ≈ -BAE_z[end:-1:1]
  V = dψV[δNp .+ (1:δNp)]
  τqs = τ - η * V
  @show maximum(abs.(τqs - BAE_τz[end:-1:1]) ./ max.(1, BAE_τz[end:-1:1]))
  @show maximum(abs.(V - BAE_V[end:-1:1]) ./ max.(1, BAE_V[end:-1:1]))
  @show maximum(abs.(log10.(V) - BAE_V_log10[end:-1:1]) ./ max.(1, BAE_V_log10[end:-1:1]))
  dθ = 1 .- BAE_V.*BAE_θ / RSDc
  dψ = dψV[1:δNp]
  @show maximum(abs.(dψ - (RSf0 .+ RSb .* log.(RSV0 .* dθ[end:-1:1] ./ RSDc))))

  # display([fault_y log10.(V) BAE_V_log10[end:-1:1] abs.(log10.(V) - BAE_V_log10[end:-1:1])])
  # @show fault_y
#=
  prob = ODEProblem(odefun, ψδ, tspan)
  Vmin = 0.0
  δmax = -1
  stepcheck(ψδ, p, t) = begin
    if reject_step[1]
      reject_step[1] = false
      println("reject")
      return true
    end
    return false
  end
  tlast = 0
  tdump = 100
  nxt_ind = 1
  fault_order = sortperm(fault_y)
  open("$(base_name)_slip.dat", "w") do f
    write(f, "tsec                   tyear                  ")
    for k = 1:length(fault_order)
      @printf f "%+.16e " fault_y[fault_order[k]]
    end
    write(f, "\n")
  end
  cb = SavingCallback((ψδ, t, i) -> begin
                        Vmax = 0.0
                        if isdefined(i, :fsallast)
                          dψV = i.fsallast
                          V  = @view dψV[δNp .+ (1:δNp) ]
                          Vmax = maximum(abs.(extrema(V)))
                          tnext = tlast + (Vmax > 1e-3 ? 0.1 : year_seconds)
                          if (t >= tnext)
                            ψ  = @view ψδ[        (1:δNp) ]
                            δ  = @view ψδ[ δNp .+ (1:δNp) ]
                            dψ = @view dψV[       (1:δNp) ]
                            tlast = tnext
                            @show (t/year_seconds, Vmax)
                            @show base_name
                            station_t[nxt_ind] = t
                              open("$(base_name)_slip.dat", "a") do f
                                @printf f "%.16e %.16e " t t/year_seconds
                                for k = 1:length(fault_order)
                                  @printf f "%+.16e " δ[fault_order[k]]
                                end
                                write(f, "\n")
                              end
                            for s = 1:numstations
                              n = station_ind[s]
                              station_V[s, nxt_ind] = V[n]
                              station_θ[s, nxt_ind] = RSDc * exp((ψ[n] - RSf0) / RSb) / RSV0
                              station_δ[s, nxt_ind] = δ[n]
                              station_τ[s, nxt_ind] = τ[n] - η * V[n]
                            end
                            @plotting let
                              p1 = plot(fault_y, τ)
                              p2 = plot(fault_y, V)
                              p3 = plot(fault_y, δ)
                              p4 = plot(fault_y, τp - τm)
                              display(plot(p1, p2, p3, p4, layout = (4,1),
                                           size = (1400, 1400),
                                           title = "time = $(t/year_seconds)"))
                              savefig((@sprintf "figs/%s_%08d.png" base_name nxt_ind))
                            end
                            nxt_ind = nxt_ind + 1
                            if nxt_ind > length(station_t)
                              old_len = length(station_t)
                              len = 2 * old_len
                              old_station_V = station_V
                              old_station_τ = station_τ
                              old_station_ψ = station_θ
                              old_station_δ = station_δ
                              station_t = Array{Float64, 1}(undef, len)
                              station_V = Array{Float64, 2}(undef, numstations,  len)
                              station_τ = Array{Float64, 2}(undef, numstations,  len)
                              station_θ = Array{Float64, 2}(undef, numstations,  len)
                              station_δ = Array{Float64, 2}(undef, numstations,  len)
                              station_t[1:old_len] .= old_station_t[1:old_len]
                              station_V[:, 1:old_len] .= old_station_V[:, 1:old_len]
                              station_τ[:, 1:old_len] .= old_station_τ[:, 1:old_len]
                              station_θ[:, 1:old_len] .= old_station_ψ[:, 1:old_len]
                              station_δ[:, 1:old_len] .= old_station_δ[:, 1:old_len]
                            end
                            if t > tdump
                              for s = 1:numstations
                                open("$(base_name)_$(stations[s]).dat", "w") do f
                                  write(f, "t slip slip_rate shear_stress state\n")
                                  for n = 1:(nxt_ind-1)
                                    write(f, "$(station_t[n]) $(station_δ[s, n]) $(log10(abs(station_V[s, n]))) $(station_τ[s, n]) $(log10(station_θ[s, n]))\n")
                                  end
                                end
                              end
                              tdump += 100
                            end
                          end
                        end
                        Vmax
                      end, SavedValues(Float64, Float64))
  sol = solve(prob, Tsit5(); isoutofdomain=stepcheck, dt=1e3,
              atol = 1e-10, rtol = 1e-10, save_everystep=false, callback=cb)
  ψδ = sol.u[end]
  ψδ[δNp .+ (1:δNp)] = ψδ[δNp .+ (1:δNp)]
  δ = @view ψδ[δNp .+ (1:δNp)]

  for s = 1:numstations
    open("$(base_name)_$(stations[s]).dat", "w") do f
      write(f, "t slip slip_rate shear_stress state\n")
      for n = 1:(nxt_ind-1)
        write(f, "$(station_t[n]) $(station_δ[s, n]) $(log10(abs(station_V[s, n]))) $(station_τ[s, n]) $(log10(station_θ[s, n]))\n")
      end
    end
  end

  #=
  dψV = zeros(2 * δNp)
  odefun(dψV, ψδ, (), tspan[end])
  V = @view dψV[δNp .+ (1:δNp)]
  @show extrema(V)
  @show extrema(δ)

  @plotting let
    #=
    mx = 0.0
    mn = 0.0
    for e = 1:nelems
      (x, y) = lop[e][4]
      Δu = u[vstarts[e]:(vstarts[e+1]-1)] - ulinear(x,y)
      mn = min(mn, minimum(Δu))
      mx = max(mx, maximum(Δu))
    end
    =#
    mx = maximum(abs.(δ))
    clims = (-mx, mx)
    p2 = plot()
    for e = 1:nelems
      (x, y) = lop[e][4]
      Δu = u[vstarts[e]:(vstarts[e+1]-1)] # - ulinear(x,y,tspan[end])
      # Δu = u[vstarts[e]:(vstarts[e+1]-1)]
      plot!(p2, reshape(x, Nr[e]+1, Ns[e]+1),
            reshape(y, Nr[e]+1, Ns[e]+1),
            reshape(Δu, Nr[e]+1, Ns[e]+1),
            st = :surface, c = :balance, clims = clims)
    end
    plot!(p2, aspect_ratio = 1, camera = (15, 26))
    # plot!(p2, aspect_ratio = 1)
    # plot!(p2, aspect_ratio = 1, camera = (45, 45))

    display(plot(p1, p2, layout = (2,1), size = (1400, 800)))
  end
  =#
  =#
  nothing
end
